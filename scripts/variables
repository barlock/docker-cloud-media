#!/bin/bash

_puid=$(printenv PUID)
_pgid=$(printenv PGID)

cloud_encrypt_dir="/cloud-encrypt"
cloud_decrypt_dir="/cloud-decrypt"

local_media_dir="/local-media"
local_encrypt_dir="/local-encrypt"
local_union_dir="/local-union"

encfs_mount_options="-o allow_other,nonempty"

plexdrive_temp_dir="/chunks"
plexdrive_options="--config=/config --cache-file=${plexdrive_temp_dir}/cache.bolt --chunk-size=$(printenv CHUNK_SIZE) --uid=${_puid:-911} --gid=${_pgid:-911} -o allow_other --root-node-id=${ROOT_NODE_ID}"
if [ ! -z $(printenv CLEAR_CHUNK_MAX_SIZE) ]; then
    plexdrive_options="${plexdrive_options} --clear-chunk-max-size=$(printenv CLEAR_CHUNK_MAX_SIZE)"
fi

if [ "$(printenv READ_ONLY)" != "0" ]; then
    plexdrive_options="${plexdrive_options} -o read_only"
fi

ufs_options="-o uid=${_puid:-911} -o gid=${_pgid:-911} -o cow,allow_other,direct_io,nonempty,auto_cache,sync_read"

log_dir="/log"
if [ ! -d "${log_dir}" ]; then
	mkdir -p "${log_dir}"
fi
